<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">

  <!-- If for some reason you are using IE, use edge -->
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <!-- So bootstrap isn't horrible, set the width -->
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="icon" type="image/png" href="/images/favicons/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="/images/favicons/favicon-16x16.png" sizes="16x16">
  <link rel="manifest" href="/images/favicons/manifest.json">
  <link rel="mask-icon" href="/images/favicons/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="theme-color" content="#ffffff">

  <title>CS 341 · Password Cracker</title>

  <!-- Reference a CDN so this is properly cached in the browser forever. Unless they clean out the
       Cache this will incur no load time. Ideally we should put a security checksum but that breaks
       Firefox development sometimes -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" crossorigin="anonymous">
  <!-- For table of content  -->

  <link rel="stylesheet" href="/css/code-style.css"/>
  <link rel="stylesheet" href="/css/main.css"/>
  <link rel="stylesheet" href="/css/bootstrap-toc.css"/>

  <meta property="og:locale" content="en_US">

  
  <meta property="og:title" content="Password Cracker" />
  

  <meta property="og:type" content="article" />
  <meta property="og:url" content="http://cs341.cs.illinois.edu" />

  
  <meta property="og:description" content=""Webpage for CS 341: System Programming at the University of Illinois Urbana-Champaign. All documentation and information about the course can be found here."
" />
  

</head>


<body data-spy="scroll" data-target="#overview" data-offset="50">
  <div class="container-fluid">
    <div class="row" style="display: flex; justify-content: stretch;">
      <!-- Always shows a header, even in smaller screens. -->
<nav class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <!-- Navigation button as html so we don't have to resize images -->
      <button
        type="button"
        class="navbar-toggle collapsed"
        data-toggle="collapse"
        data-target=".navbar-collapse"
        aria-expanded="false"
        aria-controls="navbar"
      >
        <!-- Hamburger Navigation bar on small -->
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <!-- Full title on laptop -->
      <a class="navbar-brand navbar-item normal" href="/">
             <span>CS 341: System Programming</span> 
      </a>

      <!-- Smaller on mobile-->
      <a class="navbar-brand navbar-item small" href="/">
          <span>CS 341</span>
      </a>
    </div>

    <!-- Finally generate what is in the navbar -->
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
        <li class="navbar-item">
          <a href="/assignments.html">Assignments</a>
          <!-- Generate sublinks-->
          <ul class="nav navbar-nav subitem-container">
            
          </ul>
        </li>
        
        <li class="navbar-item">
          <a href="/quiz_topics.html">Quizzes</a>
          <!-- Generate sublinks-->
          <ul class="nav navbar-nav subitem-container">
            
          </ul>
        </li>
        
        <li class="navbar-item">
          <a href="/grades.html">Grades</a>
          <!-- Generate sublinks-->
          <ul class="nav navbar-nav subitem-container">
            
          </ul>
        </li>
        
        <li class="navbar-item">
          <a href="/schedule.html">Lectures</a>
          <!-- Generate sublinks-->
          <ul class="nav navbar-nav subitem-container">
            
          </ul>
        </li>
        
        <li class="navbar-item">
          <a href="/syllabus.html">Syllabus</a>
          <!-- Generate sublinks-->
          <ul class="nav navbar-nav subitem-container">
            
          </ul>
        </li>
        
        <li class="navbar-item">
          <a href="/staff.html">Staff</a>
          <!-- Generate sublinks-->
          <ul class="nav navbar-nav subitem-container">
            
          </ul>
        </li>
        
        <li class="navbar-item">
          <a href="/resources.html">Resources</a>
          <!-- Generate sublinks-->
          <ul class="nav navbar-nav subitem-container">
            
            <li class="navbar-subitem">
              <a href="/peer_tutoring.html">Peer Tutoring</a>
            </li>
            
            <li class="navbar-subitem">
              <a href="/coursebook/index.html">Coursebook</a>
            </li>
            
            <li class="navbar-subitem">
              <a href="">Lecture Materials</a>
            </li>
            
            <li class="navbar-subitem">
              <a href="/tutorials/development">Linux Virtual Machine</a>
            </li>
            
          </ul>
        </li>
        
        <li class="navbar-item">
          <a href="/honors.html">Honors</a>
          <!-- Generate sublinks-->
          <ul class="nav navbar-nav subitem-container">
            
          </ul>
        </li>
        
      </ul>
    </div>
  </div>
  <!-- Fonts -->
  <link
    href="https://fonts.googleapis.com/css?family=Roboto"
    rel="stylesheet"
  />
</nav>

      <div class="row">
        <div class="col-sm-3 col-xs-12 hidden-xs" style="min-height: 100%">
          <nav id="overview" data-toggle="toc" class="sticky-top"></nav>
        </div>
        <div class="col-sm-9 col-xs-12">
          <div class="title">
            
            
            
            <h1>
              Password Cracker
            </h1>
          </div>
          <div class="content col-sm-11 .col-sm-offset-1">
            
            <div class="submission-wrapper">
              
              <b>Version 1 and 2</b> due <b>2025-03-24 23:59</b><br />
              
              <b>Graded files:</b>
              <ul>
                
                <li>cracker1.c</li>
                
                <li>cracker2.c</li>
                
              </ul>
              
              
            </div>
            
          </div>
          <div class="hidden-sm hidden-md hidden-lg">
            
            <div class="toc-wrapper">
<h4>Content</h4>
<ul class="toc">
<li><a id="toc_introduction" href="#introduction" class="fancy-link">Introduction</a></li>
<li><a id="toc_crypt_r" href="#crypt_r" class="fancy-link"><code class="language-plaintext highlighter-rouge">crypt_r()</code></a></li>
<li><a id="toc_problem-statement" href="#problem-statement" class="fancy-link">Problem Statement</a></li>
<li><a id="toc_input" href="#input" class="fancy-link">Input</a></li>
<li><a id="toc_version-1-thread-pool" href="#version-1-thread-pool" class="fancy-link">Version 1: Thread Pool</a></li>
<li><a id="toc_version-2-parallelize-each-task" href="#version-2-parallelize-each-task" class="fancy-link">Version 2: Parallelize each task</a></li>
<li><a id="toc_bounds" href="#bounds" class="fancy-link">Bounds</a></li>
<li><a id="toc_concept" href="#concept" class="fancy-link">Concept</a></li>
<li><a id="toc_building-and-running" href="#building-and-running" class="fancy-link">Building and Running</a></li>
<li><a id="toc_helpful-extras" href="#helpful-extras" class="fancy-link">Helpful Extras</a></li>
</ul>
</div>
            
          </div>
          <div id="content">
            
  <h2 id="learning-objectives">Learning Objectives</h2>
  <p>
    The learning objectives for Password Cracker are: <br/>
    <ul class="mdl-list">
      
        <li class="mdl-list__item">
          <span class="mdl-list__item-primary-content">Multithreaded programming and its performance gains</span>
        </li>
      
        <li class="mdl-list__item">
          <span class="mdl-list__item-primary-content">Using a thread-safe datastructure</span>
        </li>
      
        <li class="mdl-list__item">
          <span class="mdl-list__item-primary-content">Using synchronization primitives</span>
        </li>
      
    </ul>
  </p>



            <div class="wrapper">
<div class="pad"><div class="card">
<div class="title"><h2 id="introduction" class="title-text">Introduction<a class="anchor title-text" href="#introduction"> #</a>
</h2></div>







<div class="container-fluid"><div class="row"><div class="content col-sm-11 .col-sm-offset-1">
<p>In this MP, you will be creating a program that can recover lost passwords.
For security reasons, passwords are usually never stored in plain text.
Instead, the hashed versions of passwords are stored.
For an example of this, take a look at the <code class="language-plaintext highlighter-rouge">/etc/shadow</code> file on any modern Linux machine.</p>
<p>When a user tries to log in, the password they enter is hashed and compared with the stored hash.
This way, there’s no need to store your actual password.</p>
<p>Given the output of a good hash function, it is hard or impossible to reconstruct the input using the hashed value.
However, if you are willing to burn some CPU time, it is possible to try every possible password (brute force attack) until you find one that hashes to the target hash.</p>
</div></div></div>
</div></div>
<div class="pad"><div class="card">
<div class="title"><h2 id="crypt_r" class="title-text">
<code class="language-plaintext highlighter-rouge">crypt_r()</code><a class="anchor title-text" href="#crypt_r"> #</a>
</h2></div>

















<div class="container-fluid"><div class="row"><div class="content col-sm-11 .col-sm-offset-1">
<p>We will be using <code class="language-plaintext highlighter-rouge">crypt_r()</code> (a reentrant/thread-safe version of the <code class="language-plaintext highlighter-rouge">crypt()</code> function) as our hashing function.
<code class="language-plaintext highlighter-rouge">crypt_r()</code> takes three arguments: the string to hash, a salt string, a <code class="language-plaintext highlighter-rouge">struct crypt_data</code>.
Make sure to set the <code class="language-plaintext highlighter-rouge">initialized</code> member of your <code class="language-plaintext highlighter-rouge">struct crypt_data</code> to zero before using it for the first time.
For example:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>struct crypt_data cdata;
cdata.initialized = 0;

const char *hashed = crypt_r("example1", "xx", &amp;cdata);
printf("hash of 'example1' = %s\n", hashed);

hashed = crypt_r("example2", "xx", &amp;cdata);
printf("hash of 'example2' = %s\n", hashed);
</code></pre></div></div>
<p>This code outputs the following:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hash of 'example1' = xxPXiOTQGgNxc
hash of 'example2' = xx96r6/l1aOi.
</code></pre></div></div>
<p>The <code class="language-plaintext highlighter-rouge">struct crypt_data</code> is necessary for <code class="language-plaintext highlighter-rouge">crypt_r()</code>.
This is because <code class="language-plaintext highlighter-rouge">crypt()</code> stores information between invocations, so calling <code class="language-plaintext highlighter-rouge">crypt()</code> in multiple threads at the same time will cause this information to be inaccurate.
<code class="language-plaintext highlighter-rouge">crypt_r()</code> gets around this by storing information in a <code class="language-plaintext highlighter-rouge">struct crypt_data</code> instead.
You should check the man page for <code class="language-plaintext highlighter-rouge"><a href="https://man7.org/linux/man-pages/./man3/crypt_r.3.html" class="fancy-link">crypt_r</a></code>. Do you need to free the string it returns?</p>
<h3 id="why-is-there-salt-in-my-hash" class="title-text">Why is there salt in my hash?</h3>
<p>The salt argument “flavors” the string so that when you hash the same password with different salts, you’ll get different results. In practice, we might use a random value generated for every user. This prevents an attacker from noticing that two people have the same password just by comparing their hash values.</p>
<p><strong>For this assignment, always use <code class="language-plaintext highlighter-rouge">"xx"</code> for the salt argument.</strong></p>
</div></div></div>
</div></div>
<div class="pad"><div class="card">
<div class="title"><h2 id="problem-statement" class="title-text">Problem Statement<a class="anchor title-text" href="#problem-statement"> #</a>
</h2></div>









<div class="container-fluid"><div class="row"><div class="content col-sm-11 .col-sm-offset-1">
<p>You will be given a list of hashes that you must recover the passwords for. For each hash, we have two other pieces of information:</p>
<ul>
  <li>The first few letters in their password</li>
  <li>The total length of the password</li>
</ul>
<p><strong>All the passwords only contain lowercase letters!</strong></p>
<p>For example, we may say that a password begins with <code class="language-plaintext highlighter-rouge">"hello"</code> and has a total of 8 letters. We know the hashed value associated with this password is <code class="language-plaintext highlighter-rouge">"xxsczBXm6z4zA"</code>, so we simply have to try hashing each possible password (starting with the prefix provided) until we find one that hashes to the desired value.</p>
</div></div></div>
</div></div>
<div class="pad"><div class="card">
<div class="title"><h2 id="input" class="title-text">Input<a class="anchor title-text" href="#input"> #</a>
</h2></div>
















<div class="container-fluid"><div class="row"><div class="content col-sm-11 .col-sm-offset-1">
<p>Your input will be a file with one line for each password to recover. Each line will contain:</p>
<ul>
  <li>Username (1-8 characters)</li>
  <li>Password hash (13 characters)</li>
  <li>Known part of password (plus periods representing unknown characters) (1-8 characters, contains 0-8 lowercase letters followed by 0-8 periods)
    <ul>
      <li>A period in the password represents an unknown letter.</li>
    </ul>
  </li>
</ul>
<p>These three fields are separated by a single space.
Don’t worry about duplicate usernames, duplicate password hashes, or duplicate prefixes.
Each line is an independent task.</p>
<p>All input we provide is guaranteed to be in this format.</p>
<p>Example input:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>donna xxC4UjY9eNri6 hello...
eric xxqJ7cKzV3v4E zip.....
francie xxGGPN89YLcGY cham....
george xxq5aBqiB66j2 xz....
helen xxhx0AsVpMTMU sysx....
inigo xxHUf9zUctXNA miss....
</code></pre></div></div>
<p><strong>Note:</strong></p>
<ul>
  <li>For both version 1 and version 2, the main thread is NOT to be used to crack passwords. ONLY the worker threads should try to crack a password.</li>
  <li>For both, you will be editing a function called <code class="language-plaintext highlighter-rouge">start</code> that should <code class="language-plaintext highlighter-rouge">return 0</code> when exiting under normal circumstances. You can return any non-zero exit status when an error occurs.</li>
</ul>
</div></div></div>
</div></div>
<div class="pad"><div class="card">
<div class="title"><h2 id="version-1-thread-pool" class="title-text">Version 1: Thread Pool<a class="anchor title-text" href="#version-1-thread-pool"> #</a>
</h2></div>



































<div class="container-fluid"><div class="row"><div class="content col-sm-11 .col-sm-offset-1">
<p><strong>We will not grade any output which is not the result of a call to a function in <code class="language-plaintext highlighter-rouge">format.h</code></strong></p>
<p>It is <strong>always</strong> a good idea to write a single threaded version of your code before trying to parallelize!</p>
<p>Use multiple threads to speed up the password processing.
The main thread will start up a pool of worker threads, then read lines of input from standard input.
Each line will be converted to a task which is added to a task queue.
The task queue is provided in <code class="language-plaintext highlighter-rouge">libprovided.a</code> and <code class="language-plaintext highlighter-rouge">queue.h.</code>
This is the same thread-safe queue that you’ve implemented in lab!
The worker threads will pull one task from the task queue, then process the task.
When a worker thread starts processing a task, it will print the username of the task (use <code class="language-plaintext highlighter-rouge">format.h</code>).</p>
<p>When a worker thread finishes a task, it will print the cracked password (use <code class="language-plaintext highlighter-rouge">format.h</code>), along with the index of the thread (starting with index 1) and the amount of CPU time spent working on the password (use <code class="language-plaintext highlighter-rouge">getThreadCPUTime()</code>).</p>
<p>When the main thread finishes reading in lines from the input, it can’t shut down immediately, since worker threads may still be cracking some passwords.
<strong>You need to decide how to cleanly shut all the threads down when there are no more passwords to crack.</strong>
Every thread <strong>must</strong> join with the main thread!</p>
<p>After all the worker threads have exited, the main thread will print (this is provided in <code class="language-plaintext highlighter-rouge">cracker1_main.c</code>):</p>
<ul>
  <li>Number of successful and unsuccessful password cracks</li>
  <li>Wall clock time since the program was started (via <code class="language-plaintext highlighter-rouge">getTime()</code> in <code class="language-plaintext highlighter-rouge">utils.h</code>)</li>
  <li>CPU time used (a sum of the CPU time used in all threads).</li>
  <li>Proportion of CPU time to wall clock time.</li>
</ul>
<p>By default, the provided code creates 4 worker threads.
If a command line argument is supplied to the program, it will use that as the number of worker threads rather than the default.</p>
<p>Example:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ cat password_file.txt
donna xxC4UjY9eNri6 hello...
eric xxqJ7cKzV3v4E zip.....
francie xxGGPN89YLcGY cham....
george xxq5aBqiB66j2 xz....
helen xxhx0AsVpMTMU sysx....
inigo xxHUf9zUctXNA miss....
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ./cracker1 [thread_pool_size] &lt;  password_file.txt
</code></pre></div></div>
<p>Example output:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Thread 1: Start donna
Thread 4: Start francie
Thread 3: Start george
Thread 1: Password for donna is helloaac (3 hashes in 0.00 seconds)
Thread 1: Start helen
Thread 2: Start eric
Thread 2: Password for eric is zipaaazz (676 hashes in 0.00 seconds)
Thread 2: Start inigo
Thread 1: Password for helen is sysxpert (266806 hashes in 1.05 seconds)
Thread 2: Password for inigo is missudad (353552 hashes in 1.32 seconds)
Thread 4: Password for francie not found (456976 hashes in 1.65 seconds)
Thread 3: Password for george is xzzzzy (456975 hashes in 1.75 seconds)
5 passwords recovered, 1 failed.
Total time: 1.74 seconds.
Total CPU time: 5.77 seconds.
CPU usage: 3.31x
</code></pre></div></div>
<p>The times and order may vary slightly. The “CPU usage” value will depend on the number of cores in your VM. The above example is run on a machine with 4 cores. If your machine has 2 cores, the CPU usage should be between 1x and 2x.</p>
<p>Your password cracker should be processing passwords in a streaming manner. This means that once the program is started, if both a password and a worker thread are available, the thread should immediately work on the password.
Be sure to consider how your task queue is conducive to this and when you launch your threads to achieve this.</p>
<p>Note that the queue does not have a <code class="language-plaintext highlighter-rouge">queue_empty()</code> function (as explained in <code class="language-plaintext highlighter-rouge">queue.h</code>).
So a question you might ask yourself is “How do I know when the queue is empty?”.
This is an exercise we have intentionally left for the reader, but one hint we will give is “How does <code class="language-plaintext highlighter-rouge">strlen()</code> know when it has reached the end of a C style string?”. How can you reuse the same idea in terms of a queue (what is the analogue of the null byte)?</p>
<p><strong>Remember to use appropriate synchronization, and make sure to use <code class="language-plaintext highlighter-rouge"><a href="https://man7.org/linux/man-pages/./man3/crypt_r.3.html" class="fancy-link">crypt_r</a></code>.</strong>
If you create a new thread for each task (instead of keeping the threads in the thread pool running), you will lose points! (and your implementation will be very slow)</p>
</div></div></div>
</div></div>
<div class="pad"><div class="card">
<div class="title"><h2 id="version-2-parallelize-each-task" class="title-text">Version 2: Parallelize each task<a class="anchor title-text" href="#version-2-parallelize-each-task"> #</a>
</h2></div>





































<div class="container-fluid"><div class="row"><div class="content col-sm-11 .col-sm-offset-1">
<p><strong>We will not grade any output which is not the result of a call to a function in <code class="language-plaintext highlighter-rouge">format.h</code></strong></p>
<p>Version 1 works great when there is a long list of passwords that need cracking in parallel, but it’s no faster than a single threaded version when there’s one really hard password that needs cracking.
For version 2, you’ll still have a pool of threads, but rather than assigning one thread to each password task, all the threads will work in parallel on each password task.</p>
<p>Example input:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>maude xxEe0WApyDMcg a......
jesse xxsJNywggi0lA za......
francie xxGGPN89YLcGY cham....
</code></pre></div></div>
<p>Example output:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Start maude
Thread 2: Start maude at 77228944 (agnaaaa)
Thread 4: Start maude at 231686832 (atnaaaa)
Thread 1: Start maude at 0 (aaaaaaa)
Thread 3: Start maude at 154457888 (anaaaaa)
Thread 1: Stop after 308332 iterations (found)
Thread 3: Stop after 327747 iterations (cancelled)
Thread 4: Stop after 337977 iterations (cancelled)
Thread 2: Stop after 318970 iterations (cancelled)
Password for maude is aaarocx (1293026 hashes in 1.72 seconds)
Total CPU time: 6.41 seconds.
CPU usage: 3.72x
Start jesse
Thread 3: Start jesse at 154457888 (zanaaaaa)
Thread 4: Start jesse at 231686832 (zatnaaaa)
Thread 1: Start jesse at 0 (zaaaaaaa)
Thread 2: Start jesse at 77228944 (zagnaaaa)
Thread 2: Stop after 945682 iterations (found)
Thread 4: Stop after 968171 iterations (cancelled)
Thread 3: Stop after 966968 iterations (cancelled)
Thread 1: Stop after 911765 iterations (cancelled)
Password for jesse is zagpbuyj (3792586 hashes in 3.24 seconds)
Total CPU time: 12.77 seconds.
CPU usage: 3.94x
Start francie
Thread 4: Start francie at 342732 (chamtnaa)
Thread 3: Start francie at 228488 (chamnaaa)
Thread 1: Start francie at 0 (chamaaaa)
Thread 2: Start francie at 114244 (chamgnaa)
Thread 4: Stop after 114244 iterations (end)
Thread 3: Stop after 114244 iterations (end)
Thread 2: Stop after 114244 iterations (end)
Thread 1: Stop after 114244 iterations (end)
Password for francie not found (456976 hashes in 0.40 seconds)
Total CPU time: 1.53 seconds.
CPU usage: 3.81x
</code></pre></div></div>
<p>Distribute the work by splitting the search space into equal-sized chunks, one for each worker thread.
For example, if there are 3 unknown characters, then there are 26^3 = 17576 possible passwords that need to be tested.
With 4 worker threads, you would split the work up like this:</p>
<ul>
  <li>Thread 1: 0..4393 (aaa..gmz)</li>
  <li>Thread 2: 4394..8787 (gna..mzz)</li>
  <li>Thread 3: 8788..13181 (naa..tmz)</li>
  <li>Thread 4: 13182..17575 (tna..zzz)</li>
</ul>
<p>When the number of threads doesn’t divide the search space evenly, it’s easy to get off-by-one errors due to integer rounding.
The functions <code class="language-plaintext highlighter-rouge">getSubrange()</code> and <code class="language-plaintext highlighter-rouge">setStringPosition()</code> are provided in <code class="language-plaintext highlighter-rouge">utils.h</code> file to assist you with this. We <strong>require</strong> that you use these functions to match our expected output. We cannot guarantee the correctness of code that does not utilize these functions.</p>
<p>With all the threads working on the same task, you may want to restructure your thread synchronization a little.
Rather than a queue, you may wish to use a barrier.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>                Startup     Task 0..............................   Task 1..............................

main thread:    read task | idle      | print results, read next | idle      | print results, read next
worker threads: idle      | computing | idle                     | computing | idle
                          &amp;uarr;
                       barrier
</code></pre></div></div>
<p>Like with version 1, you may not create new threads for each task.
The threads you create at the beginning of the program must be the same threads that compute the last task.</p>
<p>When the main thread reads a task, it should print <code class="language-plaintext highlighter-rouge">"Start &lt;username&gt;"</code>.
When a thread starts processing a task, it should print its index and starting position.
As usual, make sure to use <code class="language-plaintext highlighter-rouge">format.h</code>.
For example:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>% echo eric xxqJ7cKzV3v4E zip..... | ./cracker2
Start eric
Thread 1: Start eric at 0 (zipaaaaa)
Thread 2: Start eric at 2970344 (zipgnaaa)
Thread 4: Start eric at 8911032 (ziptnaaa)
Thread 3: Start eric at 5940688 (zipnaaaa)
</code></pre></div></div>
<p>When a worker thread finds the correct password, it should tell all the other threads to stop working on the task.
You can implement this with a simple flag variable that each thread checks on each iteration.
Since all the threads are reading this variable and any thread may write to it, you’ll need to properly synchronize access to it.</p>
<p>When the worker threads finish a task, each thread will print the number of passwords it tried and a word describing how its run finished:</p>
<ul>
  <li>(found) - this thread found the password</li>
  <li>(cancelled) - stopped early because another thread found the password</li>
  <li>(end) - finished with no password found. Note: this can happen if the password was found, but this thread finished its chunk before another thread found the password.</li>
</ul>
<p>After all worker threads finish each task, the main thread will print the password (if found), the total number of hashes, the wall clock and CPU time spent on that task, and the ratio of CPU time to wall clock time.
Note that we have not provided any of the timing print statements in <code class="language-plaintext highlighter-rouge">cracker2</code>.</p>
</div></div></div>
</div></div>
<div class="pad"><div class="card">
<div class="title"><h2 id="bounds" class="title-text">Bounds<a class="anchor title-text" href="#bounds"> #</a>
</h2></div>









<div class="container-fluid"><div class="row"><div class="content col-sm-11 .col-sm-offset-1">
<p>2 &lt;= thread_pool_size &lt;= 13</p>
<p>1 &lt;= number of passwords &lt;= 10,000</p>
<p>0 &lt;= number of periods &lt;= 8</p>
<p>Performance: If you have n threads then CPU usage should be:</p>
<ul>
  <li>in interval [n - 0.5, n + 0.5] if 2 &lt;= n &lt;= 3</li>
  <li>more than 2 if n &gt;= 4</li>
</ul>
</div></div></div>
</div></div>
<div class="pad"><div class="card">
<div class="title"><h2 id="concept" class="title-text">Concept<a class="anchor title-text" href="#concept"> #</a>
</h2></div>





























<div class="container-fluid"><div class="row"><div class="content col-sm-11 .col-sm-offset-1">
<h3 id="latency--throughput" class="title-text">Latency &amp; Throughput</h3>
<p>By definition, latency is the delay from input into a system to desired outcome or the execution time of a single task. Throughput is the maximum rate at which something can be processed or the amount of task that could be completed in a period of time.</p>
<p>Let’s take pizza delivery for an example,</p>
<ul>
  <li>Do you want your pizza hot? Low latency = pizza arrives quicker!</li>
  <li>Or do you want your pizza to be inexpensive? High throughput = lots of pizzas per hour</li>
</ul>
<p>For the “Version 1: Thread Pool” solution, because the amount of time needed for every task is different, the tasks that need less time won’t be blocked by the tasks that needed longer time. On the other hand, the execution time for each task is longer than having all the threads working on the single task.</p>
<p>Consider the following tasks (in order), where a thread can run 100 iterations per second:</p>
<ol>
  <li>task 1: 100 iterations</li>
  <li>task 2: 10000 iterations</li>
  <li>task 3: 100 iterations</li>
  <li>task 4: 100 iterations</li>
  <li>task 5: 100 iterations</li>
</ol>
<h3 id="throughput" class="title-text">Throughput</h3>
<p>Suppose there are 4 threads available and the program runs for 1 second.</p>
<p>For version 1: The throughput is 3 since tasks 1, 3, and 4 will have completed, while 2 is still being worked on (and 5 is just being started).</p>
<p>For version 2: The throughput is 1 since only the first task will have completed and all of the threads are busy working on task 2.</p>
<h3 id="latency" class="title-text">Latency</h3>
<p>The latency is determined by how quickly each password can be cracked.</p>
<table class="table">
  <thead>
    <tr>
      <th>                  </th>
      <th>Task1</th>
      <th>Task2</th>
      <th>Task3</th>
      <th>Task4</th>
      <th>Task5</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Latency (version 1)</td>
      <td>     1</td>
      <td>   100</td>
      <td>     1</td>
      <td>    1</td>
      <td>    1</td>
    </tr>
    <tr>
      <td>Latency (version 2)</td>
      <td>   0.2</td>
      <td>    20</td>
      <td>   0.2</td>
      <td>   0.2</td>
      <td>   0.2</td>
    </tr>
  </tbody>
</table>
<p>Version 2 has much lower latency since each password is cracked faster by multiple threads working on the same task.</p>
</div></div></div>
</div></div>
<div class="pad"><div class="card">
<div class="title"><h2 id="building-and-running" class="title-text">Building and Running<a class="anchor title-text" href="#building-and-running"> #</a>
</h2></div>









<div class="container-fluid"><div class="row"><div class="content col-sm-11 .col-sm-offset-1">
<p>As usual, we have provided a Makefile which can build a <code class="language-plaintext highlighter-rouge">release</code> and a <code class="language-plaintext highlighter-rouge">debug</code> version of your code.
Running <code class="language-plaintext highlighter-rouge"><a href="https://man7.org/linux/man-pages/./man1/make.1p.html" class="fancy-link">make</a></code> will compile <code class="language-plaintext highlighter-rouge">cracker1</code> and <code class="language-plaintext highlighter-rouge">cracker2</code> in release mode, as well as a tool called <code class="language-plaintext highlighter-rouge">create_examples</code> (more on this in the next section).
Running <code class="language-plaintext highlighter-rouge">make debug</code> will compile <code class="language-plaintext highlighter-rouge">cracker1</code> and <code class="language-plaintext highlighter-rouge">cracker2</code> in debug mode, and will also compile <code class="language-plaintext highlighter-rouge">create_examples.</code></p>
<h3 id="threadsanitizer" class="title-text">ThreadSanitizer</h3>
<p>We have also included the target <code class="language-plaintext highlighter-rouge">make tsan</code>, which compiles your code with Thread Sanitizer (run <code class="language-plaintext highlighter-rouge">cracker1-tsan</code> and <code class="language-plaintext highlighter-rouge">cracker2-tsan</code>)</p>
<p>ThreadSantizer is a race condition detection tool. See <a href="http://cs341.cs.illinois.edu/coursebook/Background#tsan" class="fancy-link wiki-link">the tsan guide</a> for more information.</p>
<p><strong>We will be using ThreadSanitizer to grade your code! If the autograder detects a data race, you won’t automatically get 0 points, but a few points will be deducted.</strong></p>
</div></div></div>
</div></div>
<div class="pad"><div class="card">
<div class="title"><h2 id="helpful-extras" class="title-text">Helpful Extras<a class="anchor title-text" href="#helpful-extras"> #</a>
</h2></div>










































<div class="container-fluid"><div class="row"><div class="content col-sm-11 .col-sm-offset-1">
<h3 id="thread-status-hook" class="title-text">Thread status hook</h3>
<p>We’ve provided a simple tool to help you when debugging your program. See <code class="language-plaintext highlighter-rouge">thread_status.h</code> and <code class="language-plaintext highlighter-rouge">thread_status.c</code>. We’ve install <code class="language-plaintext highlighter-rouge">threadStatusPrint()</code> as a handler for <code class="language-plaintext highlighter-rouge">SIGINT</code>.
It will print a brief summary of what each thread is currently doing any time you hit ctrl-c.
For example:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>% ./cracker2 cracker2.in 2 100000 2
Start u0000000
Start u0000001
^C
** Thread 0: semaphore wait at cracker2.c:219
** Thread 1: processing at cracker2.c:269
** Thread 2: processing at cracker2.c:269
</code></pre></div></div>
<p>To use it:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">#include "thread_status.h"</code></li>
  <li>Call threadStatusSet() to describe what the thread is currently doing. The argument to <code class="language-plaintext highlighter-rouge">threadStatusSet()</code> should be a string constant. For example:</li>
</ul>
<pre><code class="language-C">threadStatusSet("initializing");
...
while (!done) {
  threadStatusSet("waiting for task");
  task = queue_pull(task_queue);
  threadStatusSet("processing");
  ...
}
</code></pre>
<p>When <code class="language-plaintext highlighter-rouge">threadStatusPrint()</code> is called, it doesn’t print the exact line number that each thread is at. It just prints the line number of the most recent call to <code class="language-plaintext highlighter-rouge">threadStatusSet()</code>. So, for more precise reporting, add more calls to <code class="language-plaintext highlighter-rouge">threadStatusSet()</code> to your code.</p>
<p><code class="language-plaintext highlighter-rouge">thread_status.h</code> contains macros that will redefine calls to common thread synchronization functions so that when a thread is blocking on one of them, its status will represent that (like the “semaphore wait” on line 219 in the example above).</p>
<p><strong>Note: Since Thread Status is hooked to Ctrl-C, you might need to use Ctrl-D (EOF) or Ctrl-\ (SIGQUIT) to shutdown a running password cracker</strong></p>
<p>You’re not required to use the thread status tool as part of the assignment, we just thought it might make your debugging easier.</p>
<h3 id="create_examples" class="title-text">create_examples</h3>
<p>We’ve also provided a small program to create example input files, to help you with your testing. To build the <code class="language-plaintext highlighter-rouge">create_examples</code> program, run <code class="language-plaintext highlighter-rouge">make create_examples</code>.
To use the program, write its output to a file, then use the file as input to a cracker program.
For example:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./create_examples 10 100 150 &gt; my_examples.in # write the output to a file
./cracker1 &lt; my_examples.in
</code></pre></div></div>
<p>To see what the cracked passwords should be, use the <code class="language-plaintext highlighter-rouge">-soln</code> flag when running <code class="language-plaintext highlighter-rouge">create_examples</code> (see the usage documentation given when running the program with no arguments).</p>
<h3 id="timing-example" class="title-text">timing example</h3>
<p>CPU time and so called “wall clock” time are not always the same thing.
CPU time is defined as “the amount of time your program spends running on a CPU,” and wall clock time is quite literally, the amount of time that would pass on a wall clock (the kind of clock on a wall) between the time a program starts and a program finishes running.
These numbers are often not the same!</p>
<p>If your program makes a large number of blocking system calls, it may take 10 seconds to run, but only actually consume 5 seconds of CPU time.
In this case, the kernel spent time reading from a file, or writing packets to the network, while your program sat idle.</p>
<p>CPU time can also be much larger than wall clock time.
If a program runs in multiple threads, it may use 40 seconds of CPU time, but only take 10 seconds of wall clock time (4 threads, each ran for 10 seconds).</p>
<p>To demonstrate these differences, we’ve provided a program in <code class="language-plaintext highlighter-rouge">tools/timing.c</code> which shows an example of both kinds cases.</p>
<p>To compile this program, run <code class="language-plaintext highlighter-rouge">make timing</code>, then run <code class="language-plaintext highlighter-rouge">./timing.</code> You should see output like this:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sleep(1): 1.00 seconds wall time, 0.00 seconds CPU time
single threaded cpu work: 0.14 seconds wall time, 0.14 seconds CPU time
multi threaded cpu work: 0.14 seconds wall time, 0.28 seconds CPU time
</code></pre></div></div>
</div></div></div>
</div></div>
</div>
            
            <div class="wrapper">
</div>
          </div>
          <div class="col-md-2 col-sm-1 col-xs-0"></div>
        </div>
        <!-- Mathjax takes a while to load so do a lazy load to so we can get accessibility -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" crossorigin="anonymous"></script>

<!-- Bring in JQuery and Bootstrap -->
<script src="https://code.jquery.com/jquery-3.2.1.min.js" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/js/bootstrap.min.js" crossorigin="anonymous"></script>
<!-- For table of content -->
<script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script>
<script src="/js/scroll.js"></script>
<footer class="">

<!-- Add another container at the bottom so there is some space there -->
<div class="container-fluid">
<div class="shadow"></div>

</div>

</footer>

      </div>
    </div>
  </div>
  <script type="application/javascript">
    var github_repo = "illinois-cs241/illinois-cs241.github.io";
    var github_path = "_docs/password_cracker.md";
  </script>
</body>

</html>